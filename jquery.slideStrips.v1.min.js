(function(a){function C(a){for(var d=0;d<a.length;d++)if(void 0!==document.createElement("div").style[a[d]])return a[d];return!1}function I(){var a=document.createElement("div");a.setAttribute("ontouchstart","return;");return"function"==typeof a.ontouchstart?!0:!1}a.fn.slideStrip=function(e){e=a.extend({start:0,pause:5,autoPlay:!0,slide:!1,touch:!0,controls:null,trueFit:!0,slingBack:!0,threshold:30,fallBacks:{fadeTime:0.5,slideTime:0.5},onSlideChange:function(){}},e);return this.each(function(){var d=
this,m=null,v=a(this).wrap("<div class='slideStrip'>").parent(),f=a(this).find("li");"add"==e.controls&&(a(v).append('<div class="controls"></div>'),m=a(v).find(".controls"));var g=e.start,x=null,s=!e.autoPlay,q=0,p=1,c=1;a(d).prepend("<li class='sp_invisible' style='visibility:hidden;position:relative;z-index:-1;'>"+a(f[g]).html()+"</li>");var y=C(["transform","WebkitTransform","MozTransform","OTransform","msTransform"]),k=C(["transition","WebkitTransition","MozTransition","OTransition","msTransition"]);
e.slide&&a(f).each(function(b){a(this).css("left",100*b+"%")});var z=function(b){k||a(d).clearQueue();a(f).removeClass("active");for(var h=0;h!=c;h++){a(f[b+h]).addClass("active");var t=a(f[b+h]).find("img");a(t).attr("ref")&&a(t).attr("ref")!=a(t).attr("src")&&a(t).attr("src",a(t).attr("ref"))}e.slide?(h=-(100*b),e.trueFit&&b+c>f.length-1&&(h=-q,g=-1*Math.round(h/100)),k?d.style[y]="translateX("+h+"%)":a(d).animate({left:h/p+"%"},1E3*e.fallBacks.slideTime)):e.slide||k||(a(f).fadeOut(e.fallBacks.fadeTime),
a(f[b]).fadeIn(e.fallBacks.fadeTime));m&&(a(m).find(".button").removeClass("active"),e.trueFit&&(b=Math.round(b/c+0.4)*c),a(m).find(".button[name="+b+"]").addClass("active"),g>=f.length-c&&a(m).find(".button:last-child").addClass("active"))},r=function(a){z(g);e.onSlideChange(g,f.length-c);clearTimeout(x);a||(x=setTimeout(function(){A()},1E3*e.pause))},A=function(){g+=c;g-c/2>f.length-c&&(g=e.slingBack?0:f.length-c);r(s)},D=function(){g-=c;0>g&&(g=e.slingBack&&g<=-c?f.length-c:0);r(s)},E=function(){if(m){for(var b=
"",d=0,e=0;e<f.length;e+=c)b+='<div class="button" name="'+e+'"></div>',d++;1==d?a(m).html(""):(a(m).html(b),a(m).find(".button").click(function(){g=parseFloat(a(this).attr("name"));r(s)}))}},F=function(){p=a(v).width()/a(d).width();c=Math.floor(p)||1;0.95<p-c&&c++};if(e.touch){v.addClass("touch");var B=!1,G=0,u=0,H=0,w=0,l=0,n=function(b){navigator.msMaxTouchPoints&&b.preventDefault();b||(b=window.event);var h=function(b){k?w=parseFloat(d.style[y].replace("translateX(","")):(a(d).clearQueue(),w=
parseFloat(d.style.left));H=a(d).find(".active").width();l=0;B=!0;G=parseFloat(b.clientX);parseFloat(b.clientY);u=0;clearTimeout(x);s=!0;k&&(d.style[k+"Duration"]="0s");"mousedown"==b.type&&b.preventDefault()},c=function(b,f){if(B){u=G-parseFloat(b.clientX);parseFloat(b.clientY);l=100*(u/H);k||(l/=p);if(e.slide){var c=w-l;0<c&&(c/=4);c<=-q&&(c=w>-q+25?-q+25-0.25*l:-q-0.25*l);k?d.style[y]="translateX("+c+"%)":a(d).css({left:c+"%"})}if(10<=u||-10>=u)f.preventDefault(),a(d).addClass("moving")}},f=function(b){k&&
(d.style[k+"Duration"]="");var c=e.threshold;k||(c/=p);l>c?A():l<-c?D():z(g);B=!1;if(5<=l||-5>=l)b.preventDefault(),setTimeout(function(){a(d).removeClass("moving")},100);else return!0};if(b.type)switch(b.type){case "mousemove":c(b,b);break;case "mouseup":f(b);break;case "mousedown":h(b);break;case "touchstart":h(b.targetTouches[0]);break;case "touchmove":c(b.targetTouches[0],b);break;case "touchend":f(b.targetTouches[0]);break;case "touchcancel":f(b.targetTouches[0]);break;case "touchleave":f(b.targetTouches[0]);
break;case "MSPointerMove":c(b,b);break;case "MSPointerUp":f(b);break;case "MSPointerDown":h(b);break;case "MSPointerCancel":f(b);break;case "MSPointerOut":f(b)}};e.touch&&(d.onmousedown=n,d.onmouseup=n,d.onmousemove=n,I&&(d.ontouchstart=n,d.ontouchmove=n,d.ontouchend=n,d.ontouchcancel=n,d.ontouchleave=n))}a(this).bind("loadSlide",function(a,c){g!=c&&(g=c,z(g))});a(this).bind("play",function(a,c){r(c)});a(this).bind("nextSlide",function(a){A()});a(this).bind("previousSlide",function(a){D()});e.slide&&
(a(window).resize(function(){e.slide&&F();E();g=0;r(!0);q=100*f.length-100*p}),setTimeout(function(){a(window).trigger("resize")},1E3));e.slide&&F();E();r(s)})}})(jQuery);